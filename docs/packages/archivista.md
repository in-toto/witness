# Archivista Package

## Summary

Client library for interacting with Archivista attestation storage service

## Description

The archivista package provides a Go client for the Archivista service, which stores and retrieves attestations:
- Store signed DSSE envelopes containing attestations
- Retrieve attestations by gitoid (content-addressable)
- Search for attestations by subject digest
- Download attestation collections
- Support for custom HTTP headers and authentication

## Usage

- Store attestations generated by witness
- Retrieve attestations for verification
- Build attestation transparency logs
- Query attestations by artifact digest
- Integrate with CI/CD pipelines for attestation storage

## Examples

### Search By Subject

Search for attestations by subject digest

```go
// Create client with auth headers
headers := http.Header{
    "Authorization": []string{"Bearer " + token},
}
client := archivista.New("https://archivista.example.com", 
    archivista.WithHeaders(headers))

// Search by subject digest
results, err := client.SearchGitoids(ctx, 
    cryptoutil.DigestSet{
        {Hash: crypto.SHA256}: "abcd1234...",
    })
if err != nil {
    log.Fatal(err)
}

// Process results
for _, gitoid := range results {
    fmt.Printf("Found attestation: %s\n", gitoid)
}
```

### Store Attestation

Store a DSSE envelope in Archivista

```go
// Create client
client := archivista.New("https://archivista.example.com")

// Store envelope
response, err := client.Store(ctx, envelope)
if err != nil {
    log.Fatal(err)
}

fmt.Printf("Stored with gitoid: %s\n", response.Gitoid)
```

### Retrieve Attestation

Retrieve an attestation by gitoid

```go
// Create client
client := archivista.New("https://archivista.example.com")

// Download by gitoid
envelope, err := client.Download(ctx, "gitoid:sha256:abcd1234...")
if err != nil {
    log.Fatal(err)
}

// Process retrieved envelope
fmt.Printf("Retrieved envelope with %d signatures\n", len(envelope.Signatures))
```

## Schema

```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/in-toto/go-witness/archivista/documentation",
  "$ref": "#/$defs/Documentation",
  "$defs": {
    "Documentation": {
      "properties": {
        "summary": {
          "type": "string",
          "title": "Summary",
          "description": "Brief description of the package"
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Detailed description of the package functionality"
        },
        "usage": {
          "items": {
            "type": "string"
          },
          "type": "array",
          "title": "Usage",
          "description": "Common use cases and scenarios"
        },
        "examples": {
          "additionalProperties": {
            "$ref": "#/$defs/Example"
          },
          "type": "object",
          "title": "Examples",
          "description": "Code examples demonstrating package usage"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "summary",
        "description",
        "usage",
        "examples"
      ]
    },
    "Example": {
      "properties": {
        "description": {
          "type": "string",
          "title": "Description",
          "description": "What this example demonstrates"
        },
        "code": {
          "type": "string",
          "title": "Code",
          "description": "Example code snippet"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "description",
        "code"
      ]
    }
  }
}
```
